---
title: "Exploring World Bank Data"
author: "Gustavo Arruda Franco"
output: github_document
---

## Load necessary libraries

```{r}
library(tidyverse)
```

## Write a function to import the data files

```{r}

import_data <- function(a){
  read_csv(a, skip = 4) %>% #Skip first 4 misleading rows
  select(-c(X65, `Indicator Name`)) %>% #Drop unnecessary columns
  pivot_longer(cols = c(4:63), names_to = "Year", values_to = "Value") %>% #Transform column names referencing years into a single variable
  pivot_wider(names_from = "Indicator Code", values_from = "Value") %>% #Transform rows of Indicators into columns
  select("Country Name", "Year", GINI = "SI.POV.GINI", Military_Exp_GDP = "MS.MIL.XPND.GD.ZS") %>% #Select relevant variables
  drop_na() #Drop rows with empty values
}

```


## Import the data

```{r}

full_countries <- dir("data_world_bank", pattern = "\\.csv$", full.names = TRUE) #Save all file paths into a vector
wb_gini_military <- map_df(full_countries, import_data) #Iterate importing function through vector of file paths, creating an unified data frame

```

## Explore the data

```{r}

#overall mean of each variable through years in two line charts
#scatterplot of all observations (if doesn't look ugly, if it does then just country averages). First option definitely looks ugly though

ggplot(wb_gini_military, aes(y = GINI, x = Military_Exp_GDP, color = `Country Name`)) +
  geom_jitter() +
  geom_smooth() +
  theme(legend.position = "none")


```

## Session info

```{r}
devtools::session_info()
```


